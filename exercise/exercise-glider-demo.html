

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Exercise 7 (demo) - Gliders in the Baltic &#8212; seaocn</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'exercise/exercise-glider-demo';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Assignment 1" href="../assignment/assignment-1.html" />
    <link rel="prev" title="Exercise 6 - CTD Alignment" href="exercise-ctd-align.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="seaocn - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="seaocn - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    MSc Seagoing Oceanography
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../overview/catalog-listing.html">Course catalog listing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/syllabus.html">Syllabus (SuSe24)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/schedule.html">Schedule (SuSe24)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Topics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../topics/course_overview.html">1. Course overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/scientific_basis.html">2. Scientific basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/instruments_platforms.html">3. Instruments and platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/equations_v_data.html">4. Equations v data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/amoc_methods.html">5. AMOC Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/experiment_design.html">6. Experiment design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/sensors.html">7. Sensors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/sampling_uncertainty.html">8. Sampling &amp; Uncertainty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/case_study2.html">9. Case Study 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/good_scientific_practice.html">10. Good research practice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/cruise_anatomy.html">11. Cruise anatomy</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Exercises</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="exercise-git.html">Exercise 0a - Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercise-python.html">Exercise 0b - Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercise-cnv.html">Exercise 1 - Profile data</a></li>



<li class="toctree-l1"><a class="reference internal" href="exercise-tseries.html">Exercise 2a  Time series</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercise-filter.html">Exercise 2b  Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercise-map.html">Exercise 3 - Exploring map projections</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercise-geostrophy.html">Exercise 4 -  Slopes &amp; Integrals</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercise-optimal-demo.html">Exercise 5 (demo) - Optimal interpolation</a></li>

<li class="toctree-l1"><a class="reference internal" href="exercise-ctd-align.html">Exercise 6 - CTD Alignment</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Exercise 7 (demo) - Gliders in the Baltic</a></li>



</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Assignments</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../assignment/assignment-1.html">Assignment 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignment/assignment-2.html">Assignment 2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../resource/books.html">Books + Reading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resource/git.html">Git for sharing &amp; versioning</a></li>

<li class="toctree-l1"><a class="reference internal" href="../resource/python.html">Python</a></li>

<li class="toctree-l1"><a class="reference internal" href="../resource/glossary.html">Glossary</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../build-the-book/getting-started.html">Setting up a jupyter book</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../build-the-book/jupyter-book.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build-the-book/github-pages.html">Prepare the git repositories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build-the-book/use-of-tokens.html">Use of tokens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build-the-book/regenerating-book.html">Regenerating the book after changes</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ifmeo-hamburg/seaocn" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ifmeo-hamburg/seaocn/issues/new?title=Issue%20on%20page%20%2Fexercise/exercise-glider-demo.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/exercise/exercise-glider-demo.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Exercise 7 (demo) - Gliders in the Baltic</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Exercise 7 (demo) - Gliders in the Baltic</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#update-your-environment">Update your environment</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#erddap-how-to-access-data">1. ERDDAP-How to access data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#got-an-error">Got an error?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-metadata-first">2. Load metadata first</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#download-glider-data">3. Download glider data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-aland-sea-data">a. Åland sea data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-data">Inspect the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#concatenate-datasets">Concatenate datasets</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#b-baltic-inflow">b. Baltic inflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#c-hans-storm">c. Hans storm</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-spring-blooms">d. Spring blooms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#e-specific-data-with-issues">e. Specific data with issues</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#note-on-raw-data">Note on Raw data</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#your-turn">4. Your turn</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="exercise-7-demo-gliders-in-the-baltic">
<h1>Exercise 7 (demo) - Gliders in the Baltic<a class="headerlink" href="#exercise-7-demo-gliders-in-the-baltic" title="Permalink to this heading">#</a></h1>
<p><strong>Aim:</strong> To see a different platform in action, collecting CTD (and other data). The example dataset chosen here also has some “issues”, so you can also see whether you can find a way to plot the data to display the issue.</p>
<!--**Learning outcomes:** Using what you've learned so far, you will apply this knowledge to a new dataset that you haven't previously encountered.  You will be able to apply your knowledge of sensor response, ocean-knowing-measurements, and python to articulate (and quantify) a possible issue with a dataset.  You will also see an example of how data can be loaded from the internet directly into python.-->
<p><strong>Data:</strong> You will work with data from <a class="reference external" href="https://voiceoftheocean.org">Voice of the Ocean (VOTO)</a> collected in the Baltic Sea.</p>
<p><strong>Directions:</strong> Run the python code step by step, and use it to download some data, make some starter plots, and then add some additional plots at the end yourself.</p>
<!--**Measure of success:** You will have created a python notebook, a netCDF file (*not* added to the git repository) and the 5 figures exported as `*.png` format into your folder; these will be "commited" and "pushed" to the shared repository, and viewable by everyone.  Additionally, copy your 2 best figures to the `shared_figures/` folder for discussion.  -->
<hr><section id="update-your-environment">
<h2>Update your environment<a class="headerlink" href="#update-your-environment" title="Permalink to this heading">#</a></h2>
<p>Your environment will need to contain:</p>
<ul class="simple">
<li><p>matplotlib</p></li>
<li><p>pandas</p></li>
<li><p>tqdm</p></li>
<li><p>xarrray</p></li>
<li><p>cmocean</p></li>
<li><p>erddapy</p></li>
<li><p>argopy</p></li>
</ul>
<p>This means you will probably need to add <code class="docutils literal notranslate"><span class="pre">tqdm</span></code>, <code class="docutils literal notranslate"><span class="pre">erddapy</span></code> and <code class="docutils literal notranslate"><span class="pre">argopy</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>If you’re using conda to manage your environment:</strong> If these aren’t all already in your environment, and you’re using <code class="docutils literal notranslate"><span class="pre">conda</span></code> to manage your enviroment, then you can first activate your environment (mine is called <code class="docutils literal notranslate"><span class="pre">seaocn_env</span></code>), then you can run</p>
<p><strong>If you aren’t using conda:</strong> Then you can simply install the missing packages using your usual routines (may be <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">erddapy</span></code>)</p>
<p>You may need to restart your kernal and/or jupyter-lab in order to run with the new packages in your kernel.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">mdates</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">style</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">patches</span>
<span class="kn">import</span> <span class="nn">ast</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">cmocean</span> <span class="kn">import</span> <span class="n">cm</span> <span class="k">as</span> <span class="n">cmo</span>
<span class="kn">import</span> <span class="nn">sys</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="erddap-how-to-access-data">
<h1>1. ERDDAP-How to access data<a class="headerlink" href="#erddap-how-to-access-data" title="Permalink to this heading">#</a></h1>
<p>We need some functions in order to download data from ERDDAP.  You will get these from <code class="docutils literal notranslate"><span class="pre">erddap_demo</span></code> which can be found here: <a class="github reference external" href="https://github.com/voto-ocean-knowledge/erddap_demo">voto-ocean-knowledge/erddap_demo</a></p>
<p>Use git clone to get this on your computer and the adjust the path in order to import all the functions OR just download the one file <code class="docutils literal notranslate"><span class="pre">utils.py</span></code> from the repository.</p>
<div class="admonition-warning admonition">
<p class="admonition-title">Warning!</p>
<p>After doing this, I’ve renamed it on my computer to <code class="docutils literal notranslate"><span class="pre">erddaputils.py</span></code> since <code class="docutils literal notranslate"><span class="pre">utils.py</span></code> is a fairly common package name, and I wanted to make sure I was importing the right file.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Observations
Observations portal VOTO <a class="reference external" href="https://observations.voiceoftheocean.org/">https://observations.voiceoftheocean.org/</a></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#sys.path.append(&#39;C:\\Users\\u241346\\uni_hamburg\\erddap_demo&#39;)</span>

<span class="c1"># Update the line below to specify where `erddaputils.py` can be found OR put it in your working directory.</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;/Users/eddifying/Library/Mobile Documents/com~apple~CloudDocs/Work/teaching/SeaOcn-UHH/2024-SeaOcn/05-github/erddap_demo&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">erddaputils</span> <span class="k">as</span> <span class="nn">utils</span>
</pre></div>
</div>
</div>
</div>
<section id="got-an-error">
<h2>Got an error?<a class="headerlink" href="#got-an-error" title="Permalink to this heading">#</a></h2>
<p>If you got an error trying to <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">utils</span></code> (or after renaming, <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">erddaputils</span></code>) it may be because the file is not available on your “path”.  The “path” is all the places that python will search for the file.  Update your path using <code class="docutils literal notranslate"><span class="pre">sys.path.append</span></code> OR move <code class="docutils literal notranslate"><span class="pre">utils.py</span></code> (or <code class="docutils literal notranslate"><span class="pre">erddaputils.py</span></code>) to your working directory.  Or, if you haven’t already renamed <code class="docutils literal notranslate"><span class="pre">utils.py</span></code> from this github package, then try renaming it since your python may be trying to load a <code class="docutils literal notranslate"><span class="pre">utils.py</span></code> from somewhere else.</p>
<p>Note that when you copy it, you will want the actual code (if you open <code class="docutils literal notranslate"><span class="pre">utils.py</span></code> it should look like python code).  If you have a bunch of stuff that looks like HTML (i.e., lines that start with <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> and end with <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>) then you haven’t copied the raw file when you downloaded it from the git repository, so try the download again.</p>
<hr></section>
<section id="load-metadata-first">
<h2>2. Load metadata first<a class="headerlink" href="#load-metadata-first" title="Permalink to this heading">#</a></h2>
<p>In the next section, we will download the metadata for the VOTO data to find datasets we’re interested in.  Even though we are only downloading meta data, this still takes a while (2-5 minutes).  Wait until the pink progress bar has completed before continuing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">init_erddap</span><span class="p">()</span>

<span class="c1"># Fetch dataset list of all dataset existing</span>
<span class="n">e</span><span class="o">.</span><span class="n">response</span> <span class="o">=</span> <span class="s2">&quot;csv&quot;</span>
<span class="n">e</span><span class="o">.</span><span class="n">dataset_id</span> <span class="o">=</span> <span class="s2">&quot;allDatasets&quot;</span>
<span class="n">df_datasets</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(</span><span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;minTime (UTC)&#39;</span><span class="p">,</span> <span class="s1">&#39;maxTime (UTC)&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_datasets</span><span class="p">)</span><span class="si">}</span><span class="s2"> datasets&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>found 544 datasets
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># drop the allDatasets row and make the datasetID the index for easier reading</span>
<span class="n">df_datasets</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;datasetID&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_datasets</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;allDatasets&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Get only nrt data (near real time) and not delayed as otherwise it would be very long for an intial data exploration</span>
<span class="n">df_datasets</span> <span class="o">=</span> <span class="n">df_datasets</span><span class="p">[</span><span class="n">df_datasets</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;nrt&quot;</span><span class="p">]</span>
<span class="n">ds_meta</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">dataset_id</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">df_datasets</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
    <span class="n">ds_meta</span><span class="p">[</span><span class="n">dataset_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_meta</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|                                                   | 0/211 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|▏                                          | 1/211 [00:00&lt;01:07,  3.09it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1%|▍                                          | 2/211 [00:00&lt;01:31,  2.29it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1%|▌                                          | 3/211 [00:01&lt;01:27,  2.38it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  2%|▊                                          | 4/211 [00:01&lt;01:25,  2.43it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  2%|█                                          | 5/211 [00:02&lt;01:37,  2.12it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  3%|█▏                                         | 6/211 [00:02&lt;01:55,  1.78it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  3%|█▍                                         | 7/211 [00:03&lt;02:24,  1.41it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  4%|█▋                                         | 8/211 [00:04&lt;02:05,  1.61it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  4%|█▊                                         | 9/211 [00:05&lt;02:24,  1.40it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  5%|█▉                                        | 10/211 [00:06&lt;02:26,  1.37it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  5%|██▏                                       | 11/211 [00:07&lt;03:01,  1.10it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  6%|██▍                                       | 12/211 [00:08&lt;02:48,  1.18it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  6%|██▌                                       | 13/211 [00:09&lt;02:54,  1.14it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  7%|██▊                                       | 14/211 [00:09&lt;02:17,  1.43it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  7%|██▉                                       | 15/211 [00:09&lt;01:58,  1.65it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  8%|███▏                                      | 16/211 [00:10&lt;01:46,  1.83it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  8%|███▍                                      | 17/211 [00:10&lt;01:35,  2.04it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  9%|███▌                                      | 18/211 [00:10&lt;01:17,  2.49it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  9%|███▊                                      | 19/211 [00:11&lt;01:17,  2.49it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  9%|███▉                                      | 20/211 [00:11&lt;01:17,  2.46it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 10%|████▏                                     | 21/211 [00:11&lt;01:12,  2.60it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 10%|████▍                                     | 22/211 [00:12&lt;01:14,  2.54it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 11%|████▌                                     | 23/211 [00:12&lt;01:19,  2.37it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 11%|████▊                                     | 24/211 [00:13&lt;01:27,  2.13it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 12%|████▉                                     | 25/211 [00:13&lt;01:24,  2.20it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 12%|█████▏                                    | 26/211 [00:14&lt;01:16,  2.40it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 13%|█████▎                                    | 27/211 [00:14&lt;01:14,  2.47it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 13%|█████▌                                    | 28/211 [00:15&lt;01:33,  1.96it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 14%|█████▊                                    | 29/211 [00:15&lt;01:21,  2.24it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 14%|█████▉                                    | 30/211 [00:16&lt;01:27,  2.06it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 15%|██████▏                                   | 31/211 [00:16&lt;01:24,  2.12it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 15%|██████▎                                   | 32/211 [00:17&lt;01:34,  1.90it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 16%|██████▌                                   | 33/211 [00:17&lt;01:30,  1.96it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 16%|██████▊                                   | 34/211 [00:17&lt;01:17,  2.28it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 17%|██████▉                                   | 35/211 [00:18&lt;01:13,  2.40it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 17%|███████▏                                  | 36/211 [00:18&lt;01:12,  2.40it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 18%|███████▎                                  | 37/211 [00:19&lt;01:14,  2.34it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 18%|███████▌                                  | 38/211 [00:19&lt;01:32,  1.86it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 18%|███████▊                                  | 39/211 [00:20&lt;01:28,  1.95it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 19%|███████▉                                  | 40/211 [00:20&lt;01:19,  2.16it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 19%|████████▏                                 | 41/211 [00:21&lt;01:11,  2.38it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 20%|████████▎                                 | 42/211 [00:21&lt;01:03,  2.65it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 20%|████████▌                                 | 43/211 [00:21&lt;01:09,  2.43it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 21%|████████▊                                 | 44/211 [00:22&lt;01:09,  2.40it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 21%|████████▉                                 | 45/211 [00:22&lt;01:00,  2.76it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 22%|█████████▏                                | 46/211 [00:22&lt;00:59,  2.77it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 22%|█████████▎                                | 47/211 [00:23&lt;01:01,  2.68it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 23%|█████████▌                                | 48/211 [00:23&lt;01:04,  2.52it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 23%|█████████▊                                | 49/211 [00:24&lt;01:09,  2.32it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 24%|█████████▉                                | 50/211 [00:26&lt;02:34,  1.04it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 24%|██████████▏                               | 51/211 [00:26&lt;02:03,  1.30it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 25%|██████████▎                               | 52/211 [00:27&lt;01:40,  1.59it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 25%|██████████▌                               | 53/211 [00:27&lt;01:19,  1.98it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 26%|██████████▋                               | 54/211 [00:27&lt;01:14,  2.10it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 26%|██████████▉                               | 55/211 [00:28&lt;01:25,  1.82it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 27%|███████████▏                              | 56/211 [00:29&lt;01:38,  1.57it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 27%|███████████▏                              | 56/211 [00:29&lt;01:23,  1.87it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span> <span class="mi">9</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">ds_meta</span> <span class="o">=</span> <span class="p">{}</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="k">for</span> <span class="n">dataset_id</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">df_datasets</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
<span class="ne">----&gt; </span><span class="mi">9</span>     <span class="n">ds_meta</span><span class="p">[</span><span class="n">dataset_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_meta</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">)</span>

<span class="nn">File ~/Library/Mobile Documents/com~apple~CloudDocs/Work/teaching/seaocn-teaching/2024.seaocn-uhh/coursebook-seaocn-2024/coursebook_seaocn/seaocn-cb/exercise/erddaputils.py:80,</span> in <span class="ni">get_meta</span><span class="nt">(dataset_id, protocol)</span>
<span class="g g-Whitespace">     </span><span class="mi">78</span> <span class="n">e</span> <span class="o">=</span> <span class="n">init_erddap</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="n">protocol</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">79</span> <span class="n">e</span><span class="o">.</span><span class="n">dataset_id</span> <span class="o">=</span> <span class="n">dataset_id</span>
<span class="ne">---&gt; </span><span class="mi">80</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">to_ncCF</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">81</span> <span class="n">attrs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="g g-Whitespace">     </span><span class="mi">82</span> <span class="k">for</span> <span class="n">key_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">meta</span><span class="p">):</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/erddapy/erddapy.py:368,</span> in <span class="ni">ERDDAP.to_ncCF</span><span class="nt">(self, protocol, **kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">366</span> <span class="n">protocol</span> <span class="o">=</span> <span class="n">protocol</span> <span class="k">if</span> <span class="n">protocol</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span>
<span class="g g-Whitespace">    </span><span class="mi">367</span> <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_download_url</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="s2">&quot;ncCF&quot;</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="n">distinct</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">368</span> <span class="k">return</span> <span class="n">to_ncCF</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">protocol</span><span class="p">,</span> <span class="n">requests_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">))</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/erddapy/core/interfaces.py:54,</span> in <span class="ni">to_ncCF</span><span class="nt">(url, protocol, requests_kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">50</span> <span class="k">if</span> <span class="n">protocol</span> <span class="o">==</span> <span class="s2">&quot;griddap&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">51</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">52</span>         <span class="sa">f</span><span class="s2">&quot;Cannot use .ncCF with griddap protocol. The URL you tried to access is: &#39;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span>     <span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">54</span> <span class="k">return</span> <span class="n">_nc_dataset</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">requests_kwargs</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/erddapy/core/netcdf.py:16,</span> in <span class="ni">_nc_dataset</span><span class="nt">(url, requests_kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Return a netCDF4-python Dataset from memory and fallbacks to disk if that fails.&quot;&quot;&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="kn">from</span> <span class="nn">netCDF4</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="ne">---&gt; </span><span class="mi">16</span> <span class="n">data</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">requests_kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span>     <span class="k">return</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/erddapy/core/url.py:42,</span> in <span class="ni">urlopen</span><span class="nt">(url, requests_kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span> <span class="k">if</span> <span class="n">requests_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">41</span>     <span class="n">requests_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="ne">---&gt; </span><span class="mi">42</span> <span class="n">data</span> <span class="o">=</span> <span class="n">_urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">requests_kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span> <span class="n">data</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">44</span> <span class="k">return</span> <span class="n">data</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/erddapy/core/url.py:22,</span> in <span class="ni">_urlopen</span><span class="nt">(url, auth, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span> <span class="k">if</span> <span class="s2">&quot;timeout&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span>     <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timeout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">60</span>
<span class="ne">---&gt; </span><span class="mi">22</span> <span class="n">response</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">follow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">23</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">24</span>     <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/httpx/_api.py:198,</span> in <span class="ni">get</span><span class="nt">(url, params, headers, cookies, auth, proxy, proxies, follow_redirects, cert, verify, timeout, trust_env)</span>
<span class="g g-Whitespace">    </span><span class="mi">175</span> <span class="k">def</span> <span class="nf">get</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">176</span>     <span class="n">url</span><span class="p">:</span> <span class="n">URLTypes</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">177</span>     <span class="o">*</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">188</span>     <span class="n">trust_env</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">189</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">190</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">191</span><span class="sd">     Sends a `GET` request.</span>
<span class="g g-Whitespace">    </span><span class="mi">192</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">196</span><span class="sd">     on this function, as `GET` requests should not include a request body.</span>
<span class="g g-Whitespace">    </span><span class="mi">197</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">198</span>     <span class="k">return</span> <span class="n">request</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">199</span>         <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">200</span>         <span class="n">url</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">201</span>         <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">202</span>         <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">203</span>         <span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">204</span>         <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">205</span>         <span class="n">proxy</span><span class="o">=</span><span class="n">proxy</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">206</span>         <span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">207</span>         <span class="n">follow_redirects</span><span class="o">=</span><span class="n">follow_redirects</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">208</span>         <span class="n">cert</span><span class="o">=</span><span class="n">cert</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">209</span>         <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">210</span>         <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">211</span>         <span class="n">trust_env</span><span class="o">=</span><span class="n">trust_env</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">212</span>     <span class="p">)</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/httpx/_api.py:106,</span> in <span class="ni">request</span><span class="nt">(method, url, params, content, data, files, json, headers, cookies, auth, proxy, proxies, timeout, follow_redirects, verify, cert, trust_env)</span>
<span class="g g-Whitespace">     </span><span class="mi">46</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">47</span><span class="sd"> Sends an HTTP request.</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">     </span><span class="mi">95</span><span class="sd"> ```</span>
<span class="g g-Whitespace">     </span><span class="mi">96</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">97</span> <span class="k">with</span> <span class="n">Client</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span>     <span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">99</span>     <span class="n">proxy</span><span class="o">=</span><span class="n">proxy</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">104</span>     <span class="n">trust_env</span><span class="o">=</span><span class="n">trust_env</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">105</span> <span class="p">)</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">106</span>     <span class="k">return</span> <span class="n">client</span><span class="o">.</span><span class="n">request</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">107</span>         <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span>         <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span>         <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">110</span>         <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span>         <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span>         <span class="n">json</span><span class="o">=</span><span class="n">json</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">113</span>         <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span>         <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span>         <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">116</span>         <span class="n">follow_redirects</span><span class="o">=</span><span class="n">follow_redirects</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">117</span>     <span class="p">)</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/httpx/_client.py:827,</span> in <span class="ni">Client.request</span><span class="nt">(self, method, url, content, data, files, json, params, headers, cookies, auth, follow_redirects, timeout, extensions)</span>
<span class="g g-Whitespace">    </span><span class="mi">812</span>     <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">814</span> <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_request</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">815</span>     <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">816</span>     <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">825</span>     <span class="n">extensions</span><span class="o">=</span><span class="n">extensions</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">826</span> <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">827</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">,</span> <span class="n">follow_redirects</span><span class="o">=</span><span class="n">follow_redirects</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/httpx/_client.py:928,</span> in <span class="ni">Client.send</span><span class="nt">(self, request, stream, auth, follow_redirects)</span>
<span class="g g-Whitespace">    </span><span class="mi">926</span> <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">927</span>     <span class="n">response</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">928</span>     <span class="k">raise</span> <span class="n">exc</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/httpx/_client.py:922,</span> in <span class="ni">Client.send</span><span class="nt">(self, request, stream, auth, follow_redirects)</span>
<span class="g g-Whitespace">    </span><span class="mi">920</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">921</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">stream</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">922</span>         <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">924</span>     <span class="k">return</span> <span class="n">response</span>
<span class="g g-Whitespace">    </span><span class="mi">926</span> <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/httpx/_models.py:813,</span> in <span class="ni">Response.read</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">809</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">810</span><span class="sd"> Read and return the response content.</span>
<span class="g g-Whitespace">    </span><span class="mi">811</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">812</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_content&quot;</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">813</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_content</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter_bytes</span><span class="p">())</span>
<span class="g g-Whitespace">    </span><span class="mi">814</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_content</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/httpx/_models.py:829,</span> in <span class="ni">Response.iter_bytes</span><span class="nt">(self, chunk_size)</span>
<span class="g g-Whitespace">    </span><span class="mi">827</span> <span class="n">chunker</span> <span class="o">=</span> <span class="n">ByteChunker</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">828</span> <span class="k">with</span> <span class="n">request_context</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">829</span>     <span class="k">for</span> <span class="n">raw_bytes</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_raw</span><span class="p">():</span>
<span class="g g-Whitespace">    </span><span class="mi">830</span>         <span class="n">decoded</span> <span class="o">=</span> <span class="n">decoder</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">raw_bytes</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">831</span>         <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunker</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">decoded</span><span class="p">):</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/httpx/_models.py:883,</span> in <span class="ni">Response.iter_raw</span><span class="nt">(self, chunk_size)</span>
<span class="g g-Whitespace">    </span><span class="mi">880</span> <span class="n">chunker</span> <span class="o">=</span> <span class="n">ByteChunker</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">882</span> <span class="k">with</span> <span class="n">request_context</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">883</span>     <span class="k">for</span> <span class="n">raw_stream_bytes</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">884</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_num_bytes_downloaded</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_stream_bytes</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">885</span>         <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunker</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">raw_stream_bytes</span><span class="p">):</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/httpx/_client.py:126,</span> in <span class="ni">BoundSyncStream.__iter__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">125</span> <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
<span class="ne">--&gt; </span><span class="mi">126</span>     <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stream</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">127</span>         <span class="k">yield</span> <span class="n">chunk</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/httpx/_transports/default.py:113,</span> in <span class="ni">ResponseStream.__iter__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span> <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span>     <span class="k">with</span> <span class="n">map_httpcore_exceptions</span><span class="p">():</span>
<span class="ne">--&gt; </span><span class="mi">113</span>         <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_httpcore_stream</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span>             <span class="k">yield</span> <span class="n">part</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/httpcore/_sync/connection_pool.py:367,</span> in <span class="ni">PoolByteStream.__iter__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">365</span> <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">366</span>     <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">367</span>     <span class="k">raise</span> <span class="n">exc</span> <span class="kn">from</span> <span class="kc">None</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/httpcore/_sync/connection_pool.py:363,</span> in <span class="ni">PoolByteStream.__iter__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">361</span> <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
<span class="g g-Whitespace">    </span><span class="mi">362</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">363</span>         <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stream</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">364</span>             <span class="k">yield</span> <span class="n">part</span>
<span class="g g-Whitespace">    </span><span class="mi">365</span>     <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/httpcore/_sync/http11.py:349,</span> in <span class="ni">HTTP11ConnectionByteStream.__iter__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">347</span> <span class="k">with</span> <span class="n">ShieldCancellation</span><span class="p">():</span>
<span class="g g-Whitespace">    </span><span class="mi">348</span>     <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">349</span> <span class="k">raise</span> <span class="n">exc</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/httpcore/_sync/http11.py:341,</span> in <span class="ni">HTTP11ConnectionByteStream.__iter__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">339</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">340</span>     <span class="k">with</span> <span class="n">Trace</span><span class="p">(</span><span class="s2">&quot;receive_response_body&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">341</span>         <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_connection</span><span class="o">.</span><span class="n">_receive_response_body</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">342</span>             <span class="k">yield</span> <span class="n">chunk</span>
<span class="g g-Whitespace">    </span><span class="mi">343</span> <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">344</span>     <span class="c1"># If we get an exception while streaming the response,</span>
<span class="g g-Whitespace">    </span><span class="mi">345</span>     <span class="c1"># we want to close the response (and possibly the connection)</span>
<span class="g g-Whitespace">    </span><span class="mi">346</span>     <span class="c1"># before raising that exception.</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/httpcore/_sync/http11.py:210,</span> in <span class="ni">HTTP11Connection._receive_response_body</span><span class="nt">(self, request)</span>
<span class="g g-Whitespace">    </span><span class="mi">207</span> <span class="n">timeout</span> <span class="o">=</span> <span class="n">timeouts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;read&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">209</span> <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">210</span>     <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receive_event</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">211</span>     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">h11</span><span class="o">.</span><span class="n">Data</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">212</span>         <span class="k">yield</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/httpcore/_sync/http11.py:224,</span> in <span class="ni">HTTP11Connection._receive_event</span><span class="nt">(self, timeout)</span>
<span class="g g-Whitespace">    </span><span class="mi">221</span>     <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h11_state</span><span class="o">.</span><span class="n">next_event</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">223</span> <span class="k">if</span> <span class="n">event</span> <span class="ow">is</span> <span class="n">h11</span><span class="o">.</span><span class="n">NEED_DATA</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">224</span>     <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_network_stream</span><span class="o">.</span><span class="n">read</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span>         <span class="bp">self</span><span class="o">.</span><span class="n">READ_NUM_BYTES</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span>
<span class="g g-Whitespace">    </span><span class="mi">226</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">228</span>     <span class="c1"># If we feed this case through h11 we&#39;ll raise an exception like:</span>
<span class="g g-Whitespace">    </span><span class="mi">229</span>     <span class="c1">#</span>
<span class="g g-Whitespace">    </span><span class="mi">230</span>     <span class="c1">#     httpcore.RemoteProtocolError: can&#39;t handle event type</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">234</span>     <span class="c1"># perspective. Instead we handle this case distinctly and treat</span>
<span class="g g-Whitespace">    </span><span class="mi">235</span>     <span class="c1"># it as a ConnectError.</span>
<span class="g g-Whitespace">    </span><span class="mi">236</span>     <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h11_state</span><span class="o">.</span><span class="n">their_state</span> <span class="o">==</span> <span class="n">h11</span><span class="o">.</span><span class="n">SEND_RESPONSE</span><span class="p">:</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/site-packages/httpcore/_backends/sync.py:126,</span> in <span class="ni">SyncStream.read</span><span class="nt">(self, max_bytes, timeout)</span>
<span class="g g-Whitespace">    </span><span class="mi">124</span> <span class="k">with</span> <span class="n">map_exceptions</span><span class="p">(</span><span class="n">exc_map</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">125</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_sock</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">126</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sock</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">max_bytes</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/ssl.py:1259,</span> in <span class="ni">SSLSocket.recv</span><span class="nt">(self, buflen, flags)</span>
<span class="g g-Whitespace">   </span><span class="mi">1255</span>     <span class="k">if</span> <span class="n">flags</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1256</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1257</span>             <span class="s2">&quot;non-zero flags not allowed in calls to recv() on </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
<span class="g g-Whitespace">   </span><span class="mi">1258</span>             <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1259</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">buflen</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1260</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1261</span>     <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">buflen</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/seaocn_env/lib/python3.8/ssl.py:1134,</span> in <span class="ni">SSLSocket.read</span><span class="nt">(self, len, buffer)</span>
<span class="g g-Whitespace">   </span><span class="mi">1132</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sslobj</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1133</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1134</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sslobj</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1135</span> <span class="k">except</span> <span class="n">SSLError</span> <span class="k">as</span> <span class="n">x</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1136</span>     <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">SSL_ERROR_EOF</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">suppress_ragged_eofs</span><span class="p">:</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>You can find out where VOTO data are available and since when on their “stats” page: <a class="reference external" href="https://observations.voiceoftheocean.org/stats">https://observations.voiceoftheocean.org/stats</a></p>
</div>
<p>We just downloaded information on all the datasets (but not the data!) so that now we can just find the specific datasets we want based on specific criteria.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="download-glider-data">
<h1>3. Download glider data<a class="headerlink" href="#download-glider-data" title="Permalink to this heading">#</a></h1>
<section id="a-aland-sea-data">
<h2>a. Åland sea data<a class="headerlink" href="#a-aland-sea-data" title="Permalink to this heading">#</a></h2>
<p>Åland Sea or the Sea of Åland is between Sweden and Finland.  It’s a narrow strait with  stratification and  currents.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a list of the datasets available in this region</span>
<span class="n">name</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">dataset_id</span><span class="p">,</span> <span class="n">meta</span> <span class="ow">in</span> <span class="n">ds_meta</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">meta</span><span class="p">[</span><span class="s1">&#39;deployment_start&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="s1">&#39;2023-02-01&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;Åland&#39;</span> <span class="ow">in</span> <span class="n">meta</span><span class="p">[</span><span class="s1">&#39;basin&#39;</span><span class="p">]:</span>
            <span class="n">name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s1"> datasets in Åland: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 6 datasets in Åland: [&#39;nrt_SEA076_M21&#39;, &#39;nrt_SEA076_M24&#39;, &#39;nrt_SEA066_M56&#39;, &#39;nrt_SEA077_M29&#39;, &#39;nrt_SEA056_M68&#39;, &#39;nrt_SEA078_M24&#39;]
</pre></div>
</div>
</div>
</div>
<p><strong>Near-real time vs delayed-mode data</strong></p>
<p>In this exercise, we will only use near-real time (NRT) data and not delayed mode as it would be way slower otherwise.</p>
<p>NRT data from the VOTO gliders generally contain only one file every 3-4 hours (last dive of 2-12 multi-dives).  The CTD data are additionally subsampled to datapoints every 30 seconds (instead of the nominal time interval of 1 second).</p>
<p>In deep areas such as the Åland sea, this means that in the NRT files we have approximately every other dive with 30s data. In shallower locations (e.g., the Bornholm basin), we may get one data file every 6-8 dives at 30 second time-resolution.</p>
<p>In areas with a more complex bathymetry as the Kattegat/Skagerrak area where the glider dives as deep as 200m in the north and as shallow as 40m in the south, we then receive files every 2 to 12 dives for the NRT dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download the glider dataset using the optional argument `nrt_only=True`</span>
<span class="n">ds_nrt</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">download_glider_dataset</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">nrt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|                                                       | 0/6 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA076_M21
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 17%|███████▊                                       | 1/6 [00:01&lt;00:08,  1.65s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA076_M24
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 33%|███████████████▋                               | 2/6 [00:04&lt;00:08,  2.25s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA066_M56
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 50%|███████████████████████▌                       | 3/6 [00:06&lt;00:06,  2.02s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA077_M29
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 67%|███████████████████████████████▎               | 4/6 [00:07&lt;00:03,  1.82s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA056_M68
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 83%|███████████████████████████████████████▏       | 5/6 [00:09&lt;00:01,  1.68s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA078_M24
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|███████████████████████████████████████████████| 6/6 [00:10&lt;00:00,  1.82s/it]
</pre></div>
</div>
</div>
</div>
<section id="inspect-the-data">
<h3>Inspect the data<a class="headerlink" href="#inspect-the-data" title="Permalink to this heading">#</a></h3>
<p>To start with, let’s take a look at our data.  We can do this by simply printing to the screen once we know which dataset we’re looking for.</p>
<p>Compare the two commands, to see what different information/display formats you get:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds_nrt</span><span class="p">[</span><span class="s1">&#39;nrt_SEA076_M21&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>and then separately,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ds_nrt</span><span class="p">[</span><span class="s1">&#39;nrt_SEA076_M21&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Take a look at the metadata and structure of the data.</p>
<ol class="arabic simple">
<li><p>What type are the data?</p></li>
</ol>
<!--xarray DataArray-->
<ol class="arabic simple" start="2">
<li><p>What is the “dimension”, and how long is it?</p></li>
</ol>
<!--time, and 40510-->
<ol class="arabic simple" start="3">
<li><p>What is the variable name for temperature?  for salinity?  for depth?</p></li>
</ol>
<!--temperature, salinity, depth-->
<p>Do you get different information if you do the following commands?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds_nrt</span><span class="p">[</span><span class="s1">&#39;nrt_SEA076_M21&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="nb">list</span><span class="p">(</span><span class="n">ds_nrt</span><span class="p">[</span><span class="s1">&#39;nrt_SEA076_M21&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
<span class="nb">list</span><span class="p">(</span><span class="n">ds_nrt</span><span class="p">[</span><span class="s1">&#39;nrt_SEA076_M21&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data_vars</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ds_nrt</span><span class="p">[</span><span class="s1">&#39;nrt_SEA076_M21&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#list(ds_nrt[&#39;nrt_SEA078_M24&#39;].data_vars)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="concatenate-datasets">
<h3>Concatenate datasets<a class="headerlink" href="#concatenate-datasets" title="Permalink to this heading">#</a></h3>
<p>From above, we see that there were five missions of gliders to the Åland Sea.  Rather than dealing with them separately, let’s put them all together in a single xarray DataArray.  We are going to use datasets 0 and 1 only:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">choose_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nrt_SEA076_M21&#39;</span><span class="p">,</span> <span class="s1">&#39;nrt_SEA076_M24&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">choose_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nrt_SEA076_M21&#39;</span><span class="p">,</span> <span class="s1">&#39;nrt_SEA076_M24&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">choose_name</span><span class="p">)):</span>        
    <span class="nb">print</span><span class="p">(</span><span class="n">choose_name</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nrt_SEA076_M21
nrt_SEA076_M24
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialise a dataset as empty</span>
<span class="n">full_data</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Cycle through each of the glider datasets listed in `name`</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)):</span>
    <span class="c1"># For each dataset, append it to the data in full_data (starts empty, and grows)</span>
    <span class="n">full_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds_nrt</span><span class="p">[</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="s2">&quot;backscatter_raw&quot;</span><span class="p">,</span><span class="s2">&quot;backscatter_scaled&quot;</span><span class="p">,</span><span class="s2">&quot;particulate_backscatter&quot;</span><span class="p">,</span>
                                                <span class="s2">&quot;phycocyanin&quot;</span><span class="p">,</span><span class="s2">&quot;phycocyanin_raw&quot;</span><span class="p">,</span><span class="s2">&quot;cdom&quot;</span><span class="p">,</span><span class="s2">&quot;cdom_qc&quot;</span><span class="p">,</span><span class="s2">&quot;cdom_raw&quot;</span><span class="p">,</span><span class="s2">&quot;cdom_raw_qc&quot;</span><span class="p">],</span>
                                               <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">))</span>

<span class="c1"># Concatenate datasets together along the time dimension</span>
<span class="n">full_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">full_data</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span> <span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">full_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.Dataset&gt;
Dimensions:                        (time: 294581)
Coordinates:
    latitude                       (time) float64 60.01 60.01 ... 60.0 60.0
    longitude                      (time) float64 19.69 19.69 ... 19.69 19.69
  * time                           (time) datetime64[ns] 2023-11-17T12:25:02....
    depth                          (time) float64 0.08757 0.08608 ... 1.63 2.217
Data variables: (12/52)
    ad2cp_beam1_cell_number1       (time) float32 nan nan nan ... 0.25 0.05
    ad2cp_beam2_cell_number1       (time) float32 nan nan nan ... 0.05 -0.01
    ad2cp_beam3_cell_number1       (time) float32 nan nan nan ... -0.16 -0.02
    ad2cp_beam4_cell_number1       (time) float32 nan nan nan ... 0.01 0.06 0.0
    ad2cp_heading                  (time) float32 nan nan nan ... 305.4 300.0
    ad2cp_pitch                    (time) float32 nan nan nan ... -75.7 -74.2
    ...                             ...
    security_level                 (time) float32 0.0 0.0 0.0 ... 0.0 0.0 0.0
    temperature                    (time) float32 1.635 1.654 ... 2.655 nan
    temperature_oxygen             (time) float32 3.375 3.483 ... 2.521 2.487
    temperature_qc                 (time) float32 1.0 1.0 1.0 ... 1.0 1.0 1.0
    vertical_distance_to_seafloor  (time) float32 nan nan nan ... nan nan nan
    voltage                        (time) float32 29.2 29.2 29.2 ... 24.1 24.1
Attributes: (12/76)
    acknowledgement:               This study used data collected and made fr...
    AD2CP:                         {&#39;calibration_date&#39;: &#39;2023-08-16&#39;, &#39;factor...
    basin:                         Åland Sea
    cdm_data_type:                 TimeSeries
    cdm_timeseries_variables:      profile_index
    comment:                       deployment and recovery in Gotland
    ...                            ...
    title:                         Fibbla76-20231117T1225
    total_dives:                   207.0
    transmission_system:           IRIDIUM
    variables:                     time\nlatitude\nlongitude\nnav_state\nhead...
    Westernmost_Easting:           19.290116666666666
    wmo_id:                        6801665
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="b-baltic-inflow">
<h2>b. Baltic inflow<a class="headerlink" href="#b-baltic-inflow" title="Permalink to this heading">#</a></h2>
<p>What are Baltic Inflows?</p>
<p>The deep water in the Baltic Proper is renewed during specific conditions: when salt water from the Kattegat flows through the Belt and the Sound, and fills in turn the deep areas of the Arkona Basin, the Bornholm Basin, the Eastern Gotland Basin and the western Gotland Basin. They manifest as bottom gravity currents.</p>
<p>The Baltic Sea is a very enclosed sea characterized by brakish waters, and salt water only enters through the narrow Danish straits. Water masses change in the upper layers and interlayer, but not near the bottom. The deep waters of the Baltic sea are anoxic. When large amounts of salty water from the North Sea enters the Baltic, this salty and dense oxygen-rich water can replace the anoxic deep water. Such events are called Major Baltic Inflows (MBI) which are a necessary phenomena as they allow oxygen to be replenished in the deepest parts of the Baltic.</p>
<p>Detecting Baltic inflows with observations can be a challenge. The short duration of the inflows (2–3 weeks) poses a challenge to traditional ﬁeld measurements.  As a consequence, the BIs are prone to undersampling and difﬁcult to predict. Since regular monitoring cruises in the Baltic Sea typically occur monthly or less frequently, the likelihood of missing or only partially resolving a BI is high.</p>
<p>In December, a Baltic inflow was detected. This recent inflow brought 80 km<span class="math notranslate nohighlight">\(^3\)</span> of new salty water into the Baltic Sea, making this event a medium size inflow.
The last  comparable one was over 5 years ago. The inflow corresponds to 1.6 Gt (1.6 billion t) of salt. This is the first event of this scale since the VOTO observatories started.</p>
<p>Estimated that by the beginning of February, the deep water in Bornholm Basin will be exchanged by the new salty inflow.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://news.err.ee/1609206383/rare-saltwater-inflow-in-baltic-sea-could-have-widespread-environmental-impactter">https://news.err.ee/1609206383/rare-saltwater-inflow-in-baltic-sea-could-have-widespread-environmental-impactter</a>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We want to find data from the Bornholm Basin (the first basin after the Danish straits) from early December 2023 until now</span>

<span class="n">name</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">dataset_id</span><span class="p">,</span> <span class="n">meta</span> <span class="ow">in</span> <span class="n">ds_meta</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">meta</span><span class="p">[</span><span class="s1">&#39;deployment_end&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="s1">&#39;2023-12-01&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;Bornholm&#39;</span> <span class="ow">in</span> <span class="n">meta</span><span class="p">[</span><span class="s1">&#39;basin&#39;</span><span class="p">]:</span>
            <span class="n">name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s1"> datasets in Bornholm: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 10 datasets in Bornholm: [&#39;nrt_SEA068_M30&#39;, &#39;nrt_SEA063_M69&#39;, &#39;nrt_SEA063_M71&#39;, &#39;nrt_SEA063_M72&#39;, &#39;nrt_SEA063_M73&#39;, &#39;nrt_SEA067_M51&#39;, &#39;nrt_SEA067_M53&#39;, &#39;nrt_SEA067_M55&#39;, &#39;nrt_SEA067_M56&#39;, &#39;nrt_SEA067_M58&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_nrt</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">download_glider_dataset</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">nrt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|                                                      | 0/10 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA068_M30
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 10%|████▌                                         | 1/10 [00:00&lt;00:05,  1.80it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA063_M69
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 20%|█████████▏                                    | 2/10 [00:01&lt;00:04,  1.77it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA063_M71
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 30%|█████████████▊                                | 3/10 [00:01&lt;00:03,  1.84it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA063_M72
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 40%|██████████████████▍                           | 4/10 [00:02&lt;00:03,  1.95it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA063_M73
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 50%|███████████████████████                       | 5/10 [00:02&lt;00:02,  1.87it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA067_M51
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 60%|███████████████████████████▌                  | 6/10 [00:03&lt;00:02,  1.92it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA067_M53
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 70%|████████████████████████████████▏             | 7/10 [00:03&lt;00:01,  1.91it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA067_M55
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 80%|████████████████████████████████████▊         | 8/10 [00:04&lt;00:01,  1.98it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA067_M56
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 90%|█████████████████████████████████████████▍    | 9/10 [00:04&lt;00:00,  1.95it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA067_M58
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|█████████████████████████████████████████████| 10/10 [00:05&lt;00:00,  1.96it/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">full_data</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)):</span>
    <span class="c1"># Remove offending variables while appending by using `drop_vars`</span>
    <span class="n">full_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds_nrt</span><span class="p">[</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="s2">&quot;backscatter_raw&quot;</span><span class="p">,</span><span class="s2">&quot;backscatter_scaled&quot;</span><span class="p">,</span><span class="s2">&quot;particulate_backscatter&quot;</span><span class="p">,</span>
                                                <span class="s2">&quot;phycocyanin&quot;</span><span class="p">,</span><span class="s2">&quot;phycocyanin_raw&quot;</span><span class="p">,</span><span class="s2">&quot;cdom&quot;</span><span class="p">,</span><span class="s2">&quot;cdom_qc&quot;</span><span class="p">,</span><span class="s2">&quot;cdom_raw&quot;</span><span class="p">,</span><span class="s2">&quot;cdom_raw_qc&quot;</span><span class="p">],</span>
                                                      <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">))</span>
<span class="n">full_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">full_data</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span> <span class="s1">&#39;time&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">})</span>
<span class="n">time</span><span class="o">=</span><span class="n">mdates</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
<span class="n">t</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">time</span><span class="p">,</span><span class="n">full_data</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">full_data</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmo</span><span class="o">.</span><span class="n">thermal</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">))</span>
<span class="n">s</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">time</span><span class="p">,</span><span class="n">full_data</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">full_data</span><span class="o">.</span><span class="n">salinity</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmo</span><span class="o">.</span><span class="n">haline</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">salinity</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">salinity</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">))</span>
<span class="n">d</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">time</span><span class="p">,</span><span class="n">full_data</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">full_data</span><span class="o">.</span><span class="n">density</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmo</span><span class="o">.</span><span class="n">dense</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">density</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">density</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">))</span>
<span class="n">o</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">time</span><span class="p">,</span><span class="n">full_data</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">full_data</span><span class="o">.</span><span class="n">oxygen_concentration</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmo</span><span class="o">.</span><span class="n">matter</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">oxygen_concentration</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">oxygen_concentration</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">))</span>

<span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">]</span>
<span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">]</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">reset_ticks</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">WeekdayLocator</span><span class="p">(</span><span class="n">byweekday</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">))</span>


<span class="n">cbarT</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">)</span>
<span class="n">cbarT</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Potential </span><span class="se">\n</span><span class="s1">Temperature </span><span class="se">\n</span><span class="s1">(°C)&#39;</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">cbarS</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">)</span>
<span class="n">cbarS</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Absolute </span><span class="se">\n</span><span class="s1">Salinity </span><span class="se">\n</span><span class="s1">(g kg$^{-1}$)&#39;</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">cbarD</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">)</span>
<span class="n">cbarD</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Potential </span><span class="se">\n</span><span class="s1">Density </span><span class="se">\n</span><span class="s1">(kg m$^{-3}$)&#39;</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">cbarO</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">)</span>
<span class="n">cbarO</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Oxygen </span><span class="se">\n</span><span class="s1">concentration </span><span class="se">\n</span><span class="s1">(mmol m$^{-3}$)&#39;</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">]</span>
<span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Depth (m)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Text(0, 0.5, &#39;Depth (m)&#39;),
 Text(0, 0.5, &#39;Depth (m)&#39;),
 Text(0, 0.5, &#39;Depth (m)&#39;),
 Text(0, 0.5, &#39;Depth (m)&#39;)]
</pre></div>
</div>
<img alt="../_images/f6069ec3b60684f8758b9f76d6d1572a317f25ad1f02126e57e6ee0a2cfef3c6.png" src="../_images/f6069ec3b60684f8758b9f76d6d1572a317f25ad1f02126e57e6ee0a2cfef3c6.png" />
</div>
</div>
<p><strong>Info</strong></p>
<p>There are issues with some of the oxygen data and more info can be found here <a class="reference external" href="https://observations.voiceoftheocean.org/static/img/reports/Quality_Issue_1_AROD.pdf">https://observations.voiceoftheocean.org/static/img/reports/Quality_Issue_1_AROD.pdf</a></p>
</section>
<section id="c-hans-storm">
<h2>c. Hans storm<a class="headerlink" href="#c-hans-storm" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://www.krisinformation.se/en/hazards-and-risks/disasters-and-incidents/2023/storm-hans">https://www.krisinformation.se/en/hazards-and-risks/disasters-and-incidents/2023/storm-hans</a></p>
<p><a class="reference external" href="https://www.theguardian.com/world/2023/aug/08/storm-hans-causes-havoc-in-norway-with-heaviest-rain-in-25-years-forecast">https://www.theguardian.com/world/2023/aug/08/storm-hans-causes-havoc-in-norway-with-heaviest-rain-in-25-years-forecast</a></p>
<p><a class="reference external" href="https://www.su.se/department-of-geological-sciences/news/hans-is-the-perfect-storm-globalwarming-contributed-1.664948">https://www.su.se/department-of-geological-sciences/news/hans-is-the-perfect-storm-globalwarming-contributed-1.664948</a></p>
<p>During the first week on August 2023 a strong storm hit Sweden and Norway causing big floodings and high water level in multiple areas.</p>
<p>Is it possible to see the effect of the storm on any of the glider data?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## We look for all the glider data avaialble from early July to end of August</span>
<span class="n">name</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">dataset_id</span><span class="p">,</span> <span class="n">meta</span> <span class="ow">in</span> <span class="n">ds_meta</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">meta</span><span class="p">[</span><span class="s1">&#39;deployment_start&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="s1">&#39;2023-07-01&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">meta</span><span class="p">[</span><span class="s1">&#39;deployment_start&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="s1">&#39;2023-09-01&#39;</span><span class="p">:</span>
            <span class="n">name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s1"> datasets between July 1st 2023 and September 1st 2023: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 9 datasets between July 1st 2023 and September 1st 2023: [&#39;nrt_SEA069_M15&#39;, &#39;nrt_SEA063_M62&#39;, &#39;nrt_SEA063_M63&#39;, &#39;nrt_SEA044_M83&#39;, &#39;nrt_SEA044_M84&#39;, &#39;nrt_SEA044_M85&#39;, &#39;nrt_SEA067_M46&#39;, &#39;nrt_SEA077_M24&#39;, &#39;nrt_SEA078_M14&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_nrt</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">download_glider_dataset</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">nrt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|                                                       | 0/9 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA069_M15
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 11%|█████▏                                         | 1/9 [00:00&lt;00:03,  2.28it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA063_M62
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 22%|██████████▍                                    | 2/9 [00:00&lt;00:03,  2.11it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA063_M63
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 33%|███████████████▋                               | 3/9 [00:01&lt;00:03,  1.95it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA044_M83
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 44%|████████████████████▉                          | 4/9 [00:02&lt;00:02,  1.92it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA044_M84
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 56%|██████████████████████████                     | 5/9 [00:02&lt;00:02,  1.87it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA044_M85
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 67%|███████████████████████████████▎               | 6/9 [00:03&lt;00:01,  1.77it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA067_M46
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 78%|████████████████████████████████████▌          | 7/9 [00:03&lt;00:01,  1.81it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA077_M24
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 89%|█████████████████████████████████████████▊     | 8/9 [00:05&lt;00:00,  1.23it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA078_M14
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|███████████████████████████████████████████████| 9/9 [00:06&lt;00:00,  1.40it/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## We want to see where the data  is from and get a bit more info summarized</span>
<span class="n">table</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Glider&#39;</span><span class="p">,</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span><span class="s1">&#39;Mission&#39;</span><span class="p">,</span><span class="s1">&#39;Start_Date&#39;</span><span class="p">])</span>
<span class="n">missions</span><span class="o">=</span><span class="n">name</span>
<span class="n">dic</span><span class="o">=</span><span class="n">ds_nrt</span>
<span class="n">table</span><span class="o">.</span><span class="n">Mission</span><span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">missions</span><span class="p">))</span>
    
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">missions</span><span class="p">)):</span> 
    <span class="n">d</span><span class="o">=</span><span class="n">dic</span><span class="p">[</span><span class="n">missions</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;Glider&#39;</span><span class="p">]</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;SEA0</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;glider_serial&quot;</span><span class="p">])</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;Mission&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;deployment_id&quot;</span><span class="p">])</span>
    <span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;Start_Date&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;deployment_start&quot;</span><span class="p">][:</span><span class="mi">10</span><span class="p">]</span>
    <span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;Location&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;basin&quot;</span><span class="p">]</span>


<span class="n">table</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Start_Date&quot;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Glider</th>
      <th>Location</th>
      <th>Mission</th>
      <th>Start_Date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>SEA063</td>
      <td>Bornholm Basin</td>
      <td>62</td>
      <td>2023-07-08</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SEA044</td>
      <td>Skagerrak, Kattegat</td>
      <td>83</td>
      <td>2023-07-10</td>
    </tr>
    <tr>
      <th>0</th>
      <td>SEA069</td>
      <td>Bornholm Basin</td>
      <td>15</td>
      <td>2023-07-26</td>
    </tr>
    <tr>
      <th>6</th>
      <td>SEA067</td>
      <td>Bornholm Basin</td>
      <td>46</td>
      <td>2023-07-26</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SEA077</td>
      <td>Eastern Gotland Basin, Northern Baltic Proper</td>
      <td>24</td>
      <td>2023-07-28</td>
    </tr>
    <tr>
      <th>8</th>
      <td>SEA078</td>
      <td>Western Gotland Basin</td>
      <td>14</td>
      <td>2023-07-28</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SEA044</td>
      <td>Skagerrak, Kattegat</td>
      <td>84</td>
      <td>2023-08-04</td>
    </tr>
    <tr>
      <th>2</th>
      <td>SEA063</td>
      <td>Bornholm Basin</td>
      <td>63</td>
      <td>2023-08-11</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SEA044</td>
      <td>Skagerrak, Kattegat</td>
      <td>85</td>
      <td>2023-08-23</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;We have data from </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">Location</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span><span class="si">}</span><span class="s1"> different sites during this period: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="n">Location</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>We have data from 4 different sites during this period: [&#39;Bornholm Basin&#39; &#39;Skagerrak, Kattegat&#39;
 &#39;Eastern Gotland Basin, Northern Baltic Proper&#39; &#39;Western Gotland Basin&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can try to plot data and see if anything is visible in any of the 4 areas</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_sel_data</span><span class="p">(</span><span class="n">basin</span><span class="o">=</span><span class="s1">&#39;Bornholm&#39;</span><span class="p">,</span> <span class="n">date_start</span><span class="o">=</span><span class="s1">&#39;2023-07-01&#39;</span><span class="p">,</span> <span class="n">date_end</span><span class="o">=</span><span class="s1">&#39;2023-09-01&#39;</span><span class="p">,</span> <span class="n">rectangle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">delayed</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    
    <span class="n">name</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">dataset_id</span><span class="p">,</span> <span class="n">meta</span> <span class="ow">in</span> <span class="n">ds_meta</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">meta</span><span class="p">[</span><span class="s1">&#39;deployment_start&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">date_start</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">meta</span><span class="p">[</span><span class="s1">&#39;deployment_start&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="n">date_end</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">basin</span> <span class="ow">in</span> <span class="n">meta</span><span class="p">[</span><span class="s1">&#39;basin&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="s1">&#39;SAMBA&#39;</span> <span class="ow">in</span> <span class="n">meta</span><span class="p">[</span><span class="s1">&#39;project&#39;</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">delayed</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                            <span class="n">name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;delayed</span><span class="si">{</span><span class="n">dataset_id</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">)</span>
    
        
    <span class="n">ds_nrt</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">download_glider_dataset</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">nrt_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="n">full_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)):</span>
        <span class="n">full_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds_nrt</span><span class="p">[</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="s2">&quot;backscatter_raw&quot;</span><span class="p">,</span><span class="s2">&quot;backscatter_scaled&quot;</span><span class="p">,</span><span class="s2">&quot;particulate_backscatter&quot;</span><span class="p">,</span> 
                                                    <span class="s2">&quot;phycocyanin&quot;</span><span class="p">,</span><span class="s2">&quot;phycocyanin_raw&quot;</span><span class="p">,</span><span class="s2">&quot;cdom&quot;</span><span class="p">,</span><span class="s2">&quot;cdom_qc&quot;</span><span class="p">,</span><span class="s2">&quot;cdom_raw&quot;</span><span class="p">,</span><span class="s2">&quot;cdom_raw_qc&quot;</span><span class="p">,</span>
                                                   <span class="s2">&quot;backscatter_raw_secondary&quot;</span><span class="p">,</span><span class="s2">&quot;backscatter_scaled_secondary&quot;</span><span class="p">,</span><span class="s2">&quot;chlorophyll_raw_secondary&quot;</span><span class="p">,</span>
                                                   <span class="s2">&quot;chlorophyll_secondary&quot;</span><span class="p">,</span><span class="s2">&quot;nanoflu_temperature&quot;</span><span class="p">,</span><span class="s2">&quot;phycocyanin_nanoflu&quot;</span><span class="p">],</span>
                                                    <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">))</span>
    <span class="n">full_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">full_data</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span> <span class="s1">&#39;time&#39;</span><span class="p">)</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">time</span><span class="o">=</span><span class="n">mdates</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
    <span class="n">t</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">time</span><span class="p">,</span><span class="n">full_data</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">full_data</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmo</span><span class="o">.</span><span class="n">thermal</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">))</span>
    <span class="n">s</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">time</span><span class="p">,</span><span class="n">full_data</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">full_data</span><span class="o">.</span><span class="n">salinity</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmo</span><span class="o">.</span><span class="n">haline</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">salinity</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">salinity</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">))</span>
    <span class="n">d</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">time</span><span class="p">,</span><span class="n">full_data</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">full_data</span><span class="o">.</span><span class="n">density</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmo</span><span class="o">.</span><span class="n">dense</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">density</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">density</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">))</span>
    <span class="n">o</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">time</span><span class="p">,</span><span class="n">full_data</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">full_data</span><span class="o">.</span><span class="n">oxygen_concentration</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">oxygen_concentration</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">oxygen_concentration</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">))</span>
    <span class="n">c</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">time</span><span class="p">,</span><span class="n">full_data</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">full_data</span><span class="o">.</span><span class="n">chlorophyll</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmo</span><span class="o">.</span><span class="n">algae</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">chlorophyll</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">chlorophyll</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">))</span>
    
    <span class="c1"># Highlight storm period</span>
    <span class="k">if</span> <span class="n">rectangle</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span> 
            <span class="n">rect</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">date2num</span><span class="p">([</span><span class="s1">&#39;2023-08-07&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">max</span><span class="p">())),</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
            <span class="n">a</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span> 
    
    <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">]</span>
    <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">]</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> 
    
    <span class="n">cbarT</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">)</span>
    <span class="n">cbarT</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Potential </span><span class="se">\n</span><span class="s1">Temperature </span><span class="se">\n</span><span class="s1">(°C)&#39;</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">cbarS</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">)</span>
    <span class="n">cbarS</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Absolute </span><span class="se">\n</span><span class="s1">Salinity </span><span class="se">\n</span><span class="s1">(g kg$^{-1}$)&#39;</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">cbarD</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">)</span>
    <span class="n">cbarD</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Potential </span><span class="se">\n</span><span class="s1">Density </span><span class="se">\n</span><span class="s1">(kg m$^{-3}$)&#39;</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">cbarO</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">)</span>
    <span class="n">cbarO</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Oxygen </span><span class="se">\n</span><span class="s1">concentration </span><span class="se">\n</span><span class="s1">(mmol m$^{-3}$)&#39;</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">cbarC</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">)</span>
    <span class="n">cbarC</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Chlorophyll </span><span class="se">\n</span><span class="s1">(mg m$^{-3}$)&#39;</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    
    <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">]</span>
    <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Depth (m)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">]</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_sel_data</span><span class="p">(</span><span class="n">basin</span><span class="o">=</span><span class="s1">&#39;Bornholm&#39;</span><span class="p">,</span><span class="n">date_start</span><span class="o">=</span><span class="s1">&#39;2023-07-01&#39;</span><span class="p">,</span> <span class="n">date_end</span><span class="o">=</span><span class="s1">&#39;2023-09-01&#39;</span><span class="p">,)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|███████████████████████████████████████████████| 4/4 [00:00&lt;00:00, 61.89it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA069_M15
Downloading nrt_SEA063_M62
Downloading nrt_SEA063_M63
Downloading nrt_SEA067_M46
</pre></div>
</div>
<img alt="../_images/3d40e378b93bd446ea8542f02e725a7c490cae6bd32157aeb82287a7502effe3.png" src="../_images/3d40e378b93bd446ea8542f02e725a7c490cae6bd32157aeb82287a7502effe3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_sel_data</span><span class="p">(</span><span class="n">basin</span><span class="o">=</span><span class="s1">&#39;Eastern Gotland&#39;</span><span class="p">,</span><span class="n">date_start</span><span class="o">=</span><span class="s1">&#39;2023-07-01&#39;</span><span class="p">,</span> <span class="n">date_end</span><span class="o">=</span><span class="s1">&#39;2023-09-01&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|███████████████████████████████████████████████| 1/1 [00:00&lt;00:00, 49.52it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA077_M24
</pre></div>
</div>
<img alt="../_images/a567923538d28b5c61661e5b8fd0a7f2f427088127f04b4ba40b5696a009f5d6.png" src="../_images/a567923538d28b5c61661e5b8fd0a7f2f427088127f04b4ba40b5696a009f5d6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_sel_data</span><span class="p">(</span><span class="n">basin</span><span class="o">=</span><span class="s1">&#39;Western Gotland&#39;</span><span class="p">,</span><span class="n">date_start</span><span class="o">=</span><span class="s1">&#39;2023-07-01&#39;</span><span class="p">,</span> <span class="n">date_end</span><span class="o">=</span><span class="s1">&#39;2023-09-01&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|███████████████████████████████████████████████| 1/1 [00:00&lt;00:00, 50.54it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA078_M14
</pre></div>
</div>
<img alt="../_images/b5dbfe1e71ebd6b7f78123490f333f471825d5532c4ec1acb1447249b495f2b5.png" src="../_images/b5dbfe1e71ebd6b7f78123490f333f471825d5532c4ec1acb1447249b495f2b5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_sel_data</span><span class="p">(</span><span class="n">basin</span><span class="o">=</span><span class="s1">&#39;Kattegat&#39;</span><span class="p">,</span> <span class="n">date_start</span><span class="o">=</span><span class="s1">&#39;2023-07-01&#39;</span><span class="p">,</span> <span class="n">date_end</span><span class="o">=</span><span class="s1">&#39;2023-09-01&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|███████████████████████████████████████████████| 3/3 [00:00&lt;00:00, 72.57it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA044_M83
Downloading nrt_SEA044_M84
Downloading nrt_SEA044_M85
</pre></div>
</div>
<img alt="../_images/e2e4dee5108989b4f89608c8f5722bfe741f6aec6e2a93086c3a9e1fe25697ee.png" src="../_images/e2e4dee5108989b4f89608c8f5722bfe741f6aec6e2a93086c3a9e1fe25697ee.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Temperature and salinity for Western Gotland looks weird, let#s check if we see issues in the delayed mode data as well</span>

<span class="c1">#Uncomment this line</span>
<span class="c1">#plot_sel_data(basin=&#39;Western Gotland&#39;,date_start=&#39;2023-07-01&#39;, date_end=&#39;2023-09-01&#39;, delayed=True)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="d-spring-blooms">
<h2>d. Spring blooms<a class="headerlink" href="#d-spring-blooms" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_sel_data</span><span class="p">(</span><span class="n">basin</span><span class="o">=</span><span class="s1">&#39;Bornholm&#39;</span><span class="p">,</span><span class="n">date_start</span><span class="o">=</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">date_end</span><span class="o">=</span><span class="s1">&#39;2024-01-01&#39;</span><span class="p">,</span><span class="n">rectangle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|                                                      | 0/19 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA069_M15
Downloading nrt_SEA045_M74
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 11%|████▊                                         | 2/19 [00:00&lt;00:03,  4.51it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA045_M75
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 16%|███████▎                                      | 3/19 [00:00&lt;00:04,  3.29it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA045_M79
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 21%|█████████▋                                    | 4/19 [00:01&lt;00:05,  2.85it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA063_M55
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 26%|████████████                                  | 5/19 [00:01&lt;00:04,  2.86it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA063_M60
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 32%|██████████████▌                               | 6/19 [00:02&lt;00:04,  2.82it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA063_M62
Downloading nrt_SEA063_M63
Downloading nrt_SEA063_M65
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 47%|█████████████████████▊                        | 9/19 [00:02&lt;00:02,  4.15it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA063_M67
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 53%|███████████████████████▋                     | 10/19 [00:02&lt;00:02,  3.61it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA063_M69
Downloading nrt_SEA067_M41
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 63%|████████████████████████████▍                | 12/19 [00:03&lt;00:01,  3.92it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA067_M42
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 68%|██████████████████████████████▊              | 13/19 [00:03&lt;00:01,  3.49it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA067_M44
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 74%|█████████████████████████████████▏           | 14/19 [00:04&lt;00:02,  2.40it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA067_M46
Downloading nrt_SEA067_M51
Downloading nrt_SEA077_M18
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 89%|████████████████████████████████████████▎    | 17/19 [00:05&lt;00:00,  3.43it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA056_M64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 95%|██████████████████████████████████████████▋  | 18/19 [00:05&lt;00:00,  2.97it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA056_M66
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|█████████████████████████████████████████████| 19/19 [00:06&lt;00:00,  3.16it/s]
</pre></div>
</div>
<img alt="../_images/0b8a9ded0db46f1158e7f43ab5cfa3fbfe295d4dd4ff7a295f605a320ec4dec1.png" src="../_images/0b8a9ded0db46f1158e7f43ab5cfa3fbfe295d4dd4ff7a295f605a320ec4dec1.png" />
</div>
</div>
<p><strong>Info</strong></p>
<p>There are issues with some of the oxygen data and more info can be found here <a class="reference external" href="https://observations.voiceoftheocean.org/static/img/reports/Quality_Issue_1_AROD.pdf">https://observations.voiceoftheocean.org/static/img/reports/Quality_Issue_1_AROD.pdf</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_sel_data</span><span class="p">(</span><span class="n">basin</span><span class="o">=</span><span class="s1">&#39;Eastern Gotland&#39;</span><span class="p">,</span><span class="n">date_start</span><span class="o">=</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">date_end</span><span class="o">=</span><span class="s1">&#39;2024-01-01&#39;</span><span class="p">,</span><span class="n">rectangle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|                                                       | 0/9 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA076_M16
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 11%|█████▏                                         | 1/9 [00:00&lt;00:07,  1.08it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA079_M12
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 22%|██████████▍                                    | 2/9 [00:01&lt;00:06,  1.00it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA079_M14
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 33%|███████████████▋                               | 3/9 [00:02&lt;00:05,  1.12it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA079_M16
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 44%|████████████████████▉                          | 4/9 [00:03&lt;00:04,  1.19it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA077_M21
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 56%|██████████████████████████                     | 5/9 [00:04&lt;00:03,  1.23it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA077_M22
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 67%|███████████████████████████████▎               | 6/9 [00:05&lt;00:02,  1.17it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA077_M24
Downloading nrt_SEA077_M25
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 89%|█████████████████████████████████████████▊     | 8/9 [00:06&lt;00:00,  1.54it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA077_M28
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|███████████████████████████████████████████████| 9/9 [00:06&lt;00:00,  1.30it/s]
</pre></div>
</div>
<img alt="../_images/779f211c0c8466f450ea914cb6bb54f66ec7854abd04049dc08d371fefacc0f5.png" src="../_images/779f211c0c8466f450ea914cb6bb54f66ec7854abd04049dc08d371fefacc0f5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_sel_data</span><span class="p">(</span><span class="n">basin</span><span class="o">=</span><span class="s1">&#39;Skagerrak&#39;</span><span class="p">,</span><span class="n">date_start</span><span class="o">=</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">date_end</span><span class="o">=</span><span class="s1">&#39;2024-01-01&#39;</span><span class="p">,</span><span class="n">rectangle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|                                                      | 0/16 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA069_M19
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  6%|██▉                                           | 1/16 [00:00&lt;00:06,  2.39it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA069_M21
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 12%|█████▊                                        | 2/16 [00:00&lt;00:05,  2.66it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA069_M22
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 19%|████████▋                                     | 3/16 [00:01&lt;00:04,  2.69it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA069_M23
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 25%|███████████▌                                  | 4/16 [00:01&lt;00:04,  2.56it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA055_M54
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 31%|██████████████▍                               | 5/16 [00:01&lt;00:04,  2.56it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA055_M56
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 38%|█████████████████▎                            | 6/16 [00:02&lt;00:03,  2.62it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA044_M72
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 44%|████████████████████▏                         | 7/16 [00:02&lt;00:03,  2.61it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA044_M75
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 50%|███████████████████████                       | 8/16 [00:03&lt;00:02,  2.68it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA044_M77
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 56%|█████████████████████████▉                    | 9/16 [00:03&lt;00:02,  2.64it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA044_M78
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 62%|████████████████████████████▏                | 10/16 [00:03&lt;00:02,  2.49it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA044_M79
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 69%|██████████████████████████████▉              | 11/16 [00:04&lt;00:01,  2.53it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA044_M81
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 75%|█████████████████████████████████▊           | 12/16 [00:04&lt;00:01,  2.40it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading nrt_SEA044_M83
Downloading nrt_SEA044_M84
Downloading nrt_SEA044_M85
Downloading nrt_SEA044_M86
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|█████████████████████████████████████████████| 16/16 [00:05&lt;00:00,  3.13it/s]
</pre></div>
</div>
<img alt="../_images/af63684da35f5da1bde312dc5574fbb3ca6363ae851008c96ec0ca497340d69e.png" src="../_images/af63684da35f5da1bde312dc5574fbb3ca6363ae851008c96ec0ca497340d69e.png" />
</div>
</div>
</section>
<section id="e-specific-data-with-issues">
<h2>e. Specific data with issues<a class="headerlink" href="#e-specific-data-with-issues" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SEA070 with pumped SeaBird CTD</span>
<span class="n">name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;delayed_SEA070_M15&#39;</span><span class="p">,</span> <span class="s1">&#39;delayed_SEA070_M15&#39;</span><span class="p">]</span>
<span class="n">ds_delayed</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">download_glider_dataset</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">nrt_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|                                                       | 0/2 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found delayed_SEA070_M15 in voto_erddap_data_cache. Loading from disk
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 50%|███████████████████████▌                       | 1/2 [00:28&lt;00:28, 28.12s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found delayed_SEA070_M15 in voto_erddap_data_cache. Loading from disk
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|███████████████████████████████████████████████| 2/2 [00:29&lt;00:00, 14.90s/it]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">full_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)):</span>
    <span class="n">full_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds_delayed</span><span class="p">[</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
<span class="n">full_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">full_data</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span> <span class="s1">&#39;time&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">})</span>
<span class="n">time</span><span class="o">=</span><span class="n">mdates</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
<span class="n">t</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">time</span><span class="p">,</span><span class="n">full_data</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">full_data</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmo</span><span class="o">.</span><span class="n">thermal</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">))</span>
<span class="n">s</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">time</span><span class="p">,</span><span class="n">full_data</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">full_data</span><span class="o">.</span><span class="n">salinity</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmo</span><span class="o">.</span><span class="n">haline</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">salinity</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">salinity</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">))</span>
<span class="n">d</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">time</span><span class="p">,</span><span class="n">full_data</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">full_data</span><span class="o">.</span><span class="n">density</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmo</span><span class="o">.</span><span class="n">dense</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">density</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">density</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">))</span>
<span class="n">o</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">time</span><span class="p">,</span><span class="n">full_data</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">full_data</span><span class="o">.</span><span class="n">oxygen_frequency</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">oxygen_frequency</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">oxygen_frequency</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">))</span>
<span class="n">c</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">time</span><span class="p">,</span><span class="n">full_data</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">full_data</span><span class="o">.</span><span class="n">chlorophyll</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmo</span><span class="o">.</span><span class="n">algae</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">chlorophyll</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">chlorophyll</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">))</span>
    
<span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">full_data</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">10</span><span class="p">),</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">]</span>
<span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">]</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">reset_ticks</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">WeekdayLocator</span><span class="p">(</span><span class="n">byweekday</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">))</span>


<span class="n">cbarT</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">)</span>
<span class="n">cbarT</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Potential </span><span class="se">\n</span><span class="s1">Temperature </span><span class="se">\n</span><span class="s1">(°C)&#39;</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">cbarS</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">)</span>
<span class="n">cbarS</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Absolute </span><span class="se">\n</span><span class="s1">Salinity </span><span class="se">\n</span><span class="s1">(g kg$^{-1}$)&#39;</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">cbarD</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">)</span>
<span class="n">cbarD</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Potential </span><span class="se">\n</span><span class="s1">Density </span><span class="se">\n</span><span class="s1">(kg m$^{-3}$)&#39;</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">cbarO</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">)</span>
<span class="n">cbarO</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Oxygen </span><span class="se">\n</span><span class="s1">concentration </span><span class="se">\n</span><span class="s1">(mmol m$^{-3}$)&#39;</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">cbarC</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">)</span>
<span class="n">cbarC</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Chlorophyll </span><span class="se">\n</span><span class="s1">(mg m$^{-3}$)&#39;</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">]</span>
<span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Depth (m)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Text(0, 0.5, &#39;Depth (m)&#39;),
 Text(0, 0.5, &#39;Depth (m)&#39;),
 Text(0, 0.5, &#39;Depth (m)&#39;),
 Text(0, 0.5, &#39;Depth (m)&#39;),
 Text(0, 0.5, &#39;Depth (m)&#39;)]
</pre></div>
</div>
<img alt="../_images/30a6514e3a4e822a9fe91e37ac50ef53de3094adc71e35f5443c00871aea7c97.png" src="../_images/30a6514e3a4e822a9fe91e37ac50ef53de3094adc71e35f5443c00871aea7c97.png" />
</div>
</div>
</section>
<section id="note-on-raw-data">
<h2>Note on Raw data<a class="headerlink" href="#note-on-raw-data" title="Permalink to this heading">#</a></h2>
<p>These are all raw data and many adjustments have to be applied and various issues/sources should be considered.  These include:</p>
<ul class="simple">
<li><p>Thermal hysteresis</p></li>
<li><p>Quenching corrections</p></li>
<li><p>Calibration (ex. optics dark count correction and scaling factor correction, oxygen calibration etc..)</p></li>
<li><p>Electrical spikes</p></li>
<li><p>Outliers</p></li>
<li><p>Sensor failure</p></li>
<li><p>Specific sensor issues (FLBBPC issues, FLBBCD issues, AROD and CODA issues)</p></li>
<li><p>other?</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="your-turn">
<h1>4. Your turn<a class="headerlink" href="#your-turn" title="Permalink to this heading">#</a></h1>
<p>Create a new notebook to work with just one of these datasets.</p>
<ol class="arabic simple">
<li><p>Pick a dataset, and copy the code from this notebook into your new notebook to load the data.</p></li>
<li><p>Repeat some of the basic plots.</p></li>
<li><p>Explore how to make a section plot from the glider data for a specific variable only.</p></li>
<li><p>Can you make another plot type?  Maybe a T-S plot, or a T-S plot coloured by oxygen (or chlorophyll fluorescence).  Or a profile plot.</p></li>
</ol>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "conda-root-py"
        },
        kernelOptions: {
            name: "conda-root-py",
            path: "./exercise"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'conda-root-py'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="exercise-ctd-align.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Exercise 6 - CTD Alignment</p>
      </div>
    </a>
    <a class="right-next"
       href="../assignment/assignment-1.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Assignment 1</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Exercise 7 (demo) - Gliders in the Baltic</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#update-your-environment">Update your environment</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#erddap-how-to-access-data">1. ERDDAP-How to access data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#got-an-error">Got an error?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-metadata-first">2. Load metadata first</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#download-glider-data">3. Download glider data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-aland-sea-data">a. Åland sea data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-data">Inspect the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#concatenate-datasets">Concatenate datasets</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#b-baltic-inflow">b. Baltic inflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#c-hans-storm">c. Hans storm</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-spring-blooms">d. Spring blooms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#e-specific-data-with-issues">e. Specific data with issues</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#note-on-raw-data">Note on Raw data</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#your-turn">4. Your turn</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Eleanor Frajka-Williams
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>